#!/bin/bash

# every 4 seconds calls the api with a payload that is an intrusion
BODY="'{\"duration\":0,\"src_bytes\":0.00020094717776309186,\"dst_bytes\":0,\"land\":0,\"wrong_fragment\":0,\"urgent\":0,\"hot\":0,\"num_failed_logins\":0,\"logged_in\":0,\"num_compromised\":0,\"root_shell\":0,\"su_attempted\":0,\"num_root\":0,\"num_file_creations\":0,\"num_shells\":0,\"num_access_files\":0,\"is_guest_login\":0,\"count\":0.9980430528375733,\"srv_count\":0.9980430528375733,\"serror_rate\":0,\"srv_serror_rate\":0,\"rerror_rate\":0,\"srv_rerror_rate\":0,\"same_srv_rate\":1,\"diff_srv_rate\":0,\"srv_diff_host_rate\":0,\"dst_host_count\":1,\"dst_host_srv_count\":1,\"dst_host_same_srv_rate\":1,\"dst_host_diff_srv_rate\":0,\"dst_host_same_src_port_rate\":1,\"dst_host_srv_diff_host_rate\":0,\"dst_host_serror_rate\":0,\"dst_host_srv_serror_rate\":0,\"dst_host_rerror_rate\":0,\"dst_host_srv_rerror_rate\":0,\"protocol_type_icmp\":1,\"protocol_type_tcp\":0,\"protocol_type_udp\":0,\"service_IRC\":0,\"service_X11\":0,\"service_Z39_50\":0,\"service_auth\":0,\"service_bgp\":0,\"service_courier\":0,\"service_csnet_ns\":0,\"service_ctf\":0,\"service_daytime\":0,\"service_discard\":0,\"service_domain\":0,\"service_domain_u\":0,\"service_echo\":0,\"service_eco_i\":0,\"service_ecr_i\":1,\"service_efs\":0,\"service_exec\":0,\"service_finger\":0,\"service_ftp\":0,\"service_ftp_data\":0,\"service_gopher\":0,\"service_hostnames\":0,\"service_http\":0,\"service_http_443\":0,\"service_imap4\":0,\"service_iso_tsap\":0,\"service_klogin\":0,\"service_kshell\":0,\"service_ldap\":0,\"service_link\":0,\"service_login\":0,\"service_mtp\":0,\"service_name\":0,\"service_netbios_dgm\":0,\"service_netbios_ns\":0,\"service_netbios_ssn\":0,\"service_netstat\":0,\"service_nnsp\":0,\"service_nntp\":0,\"service_ntp_u\":0,\"service_other\":0,\"service_pop_2\":0,\"service_pop_3\":0,\"service_printer\":0,\"service_private\":0,\"service_remote_job\":0,\"service_rje\":0,\"service_shell\":0,\"service_smtp\":0,\"service_sql_net\":0,\"service_ssh\":0,\"service_sunrpc\":0,\"service_supdup\":0,\"service_systat\":0,\"service_telnet\":0,\"service_tim_i\":0,\"service_time\":0,\"service_urh_i\":0,\"service_urp_i\":0,\"service_uucp\":0,\"service_uucp_path\":0,\"service_vmnet\":0,\"service_whois\":0,\"flag_OTH\":0,\"flag_REJ\":0,\"flag_RSTO\":0,\"flag_RSTOS0\":0,\"flag_RSTR\":0,\"flag_S0\":0,\"flag_S1\":0,\"flag_S2\":0,\"flag_S3\":0,\"flag_SF\":1,\"flag_SH\":0}'"
watch -n 4 "curl -d $BODY 'http://localhost:8000/is_intrusion'" 